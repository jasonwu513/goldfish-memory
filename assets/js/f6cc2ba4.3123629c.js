"use strict";(self.webpackChunkdiary=self.webpackChunkdiary||[]).push([[7002],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>s});var l=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,l,r=function(e,t){if(null==e)return{};var n,l,r={},o=Object.keys(e);for(l=0;l<o.length;l++)n=o[l],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(l=0;l<o.length;l++)n=o[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=l.createContext({}),u=function(e){var t=l.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=u(e.components);return l.createElement(p.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},k=l.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),k=u(n),s=r,d=k["".concat(p,".").concat(s)]||k[s]||f[s]||o;return n?l.createElement(d,a(a({ref:t},c),{},{components:n})):l.createElement(d,a({ref:t},c))}));function s(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=k;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,a[1]=i;for(var u=2;u<o;u++)a[u]=n[u];return l.createElement.apply(null,a)}return l.createElement.apply(null,n)}k.displayName="MDXCreateElement"},65771:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>f,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var l=n(87462),r=(n(67294),n(3905));const o={},a="Loki",i={unversionedId:"Software/log/loki",id:"Software/log/loki",title:"Loki",description:"\u89c0\u5ff5",source:"@site/docs/Software/log/loki.md",sourceDirName:"Software/log",slug:"/Software/log/loki",permalink:"/goldfish-memory/docs/Software/log/loki",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Software/log/loki.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u67b6\u8a2dLDAP \u7df4\u7fd2\u74b0\u5883",permalink:"/goldfish-memory/docs/Software/ldap/"},next:{title:"yt-dlp",permalink:"/goldfish-memory/docs/Video/yt-dlp/intro"}},p={},u=[{value:"\u89c0\u5ff5",id:"\u89c0\u5ff5",level:2},{value:"\u70ba\u4f55\u9078\u64c7\u6b64\u65b9\u6848",id:"\u70ba\u4f55\u9078\u64c7\u6b64\u65b9\u6848",level:2},{value:"Grafana + LOKI + promtail \u8a2d\u5b9a\u6a94",id:"grafana--loki--promtail-\u8a2d\u5b9a\u6a94",level:2},{value:"GRAFANA \u8a2d\u5b9a",id:"grafana-\u8a2d\u5b9a",level:2},{value:"Fluent-bit",id:"fluent-bit",level:2},{value:"\u8f09\u9ede",id:"\u8f09\u9ede",level:3},{value:"\u8a2d\u5b9a\u6a94",id:"\u8a2d\u5b9a\u6a94",level:3},{value:"LOG \u7522\u751f\u5668 (\u5982\u679c\u6c92\u6709LOG \u53ef\u4f7f\u7528\u4e0b\u5217 repo \u7522\u751fLOG)",id:"log-\u7522\u751f\u5668-\u5982\u679c\u6c92\u6709log-\u53ef\u4f7f\u7528\u4e0b\u5217-repo-\u7522\u751flog",level:2},{value:"@INCLUDE \u5f15\u7528\u591a\u500b\u8a2d\u5b9a\u6a94",id:"include-\u5f15\u7528\u591a\u500b\u8a2d\u5b9a\u6a94",level:2},{value:"\u8a2d\u5b9a\u53c3\u8003",id:"\u8a2d\u5b9a\u53c3\u8003",level:2},{value:"\u5099\u8a3b",id:"\u5099\u8a3b",level:2}],c={toc:u};function f(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,l.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"loki"},"Loki"),(0,r.kt)("h2",{id:"\u89c0\u5ff5"},"\u89c0\u5ff5"),(0,r.kt)("p",null,"\u900f\u904e\u5404\u7a2eagent ex: fluent-bit , promtail ..., \u5c07LOG \u96c6\u4e2d\u5132\u5b58\u81f3LOKI, \u518d\u5229\u7528GRAFANA UI \u4f5c\u5448\u73fe"),(0,r.kt)("h2",{id:"\u70ba\u4f55\u9078\u64c7\u6b64\u65b9\u6848"},"\u70ba\u4f55\u9078\u64c7\u6b64\u65b9\u6848"),(0,r.kt)("h2",{id:"grafana--loki--promtail-\u8a2d\u5b9a\u6a94"},"Grafana + LOKI + promtail \u8a2d\u5b9a\u6a94"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'version: "3"\n\nnetworks:\n  loki:\n\nservices:\n  loki:\n    image: grafana/loki:2.6.1\n    # volumes:\n    #   - "./loki:/loki"\n    ports:\n      - "3100:3100"\n    command: -config.file=/etc/loki/local-config.yaml\n    restart: always\n    networks:\n      - loki\n\n  grafana:\n    image: grafana/grafana:latest\n    ports:\n      - "6000:3000"\n    restart: always\n    networks:\n      - loki\n')),(0,r.kt)("p",null,"docker-compose up -d \u555f\u52d5\u5f8c"),(0,r.kt)("p",null,"\u4e0b\u6307\u4ee4\u5c07docker loki \u5132\u5b58\u7a7a\u9593\u8907\u88fd\u51fa\u4f86"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker cp loki_docker_id:/loki .\n")),(0,r.kt)("p",null,"\u95dc\u9589container "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose down\n")),(0,r.kt)("p",null,"\u53d6\u6d88docker-compose.yml \u8a3b\u89e3, \u4f7floki \u5167\u5bb9\u6301\u4e45\u5316"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'    # volumes:\n    #   - "./loki:/loki"\n')),(0,r.kt)("p",null,"\u91cd\u555f container."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose  up -d\n")),(0,r.kt)("h2",{id:"grafana-\u8a2d\u5b9a"},"GRAFANA \u8a2d\u5b9a"),(0,r.kt)("p",null,"\u767b\u5165Grafana\u5f8c \u65b0\u589e Data Source",(0,r.kt)("br",{parentName:"p"}),"\n","Type: Loki ,\nURL: http://loki:3100\n\u6b64\u7aef\u53e3\u7528\u65bc\u63a5\u6536AGENT \u50b3\u9001\u4e4bLOG"),(0,r.kt)("h2",{id:"fluent-bit"},"Fluent-bit"),(0,r.kt)("h3",{id:"\u8f09\u9ede"},"\u8f09\u9ede"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.fluentbit.io/manual/installation/getting-started-with-fluent-bit"},"https://docs.fluentbit.io/manual/installation/getting-started-with-fluent-bit")),(0,r.kt)("p",null,"\u4e0b\u8f09 windows zip \u6a94"),(0,r.kt)("h3",{id:"\u8a2d\u5b9a\u6a94"},"\u8a2d\u5b9a\u6a94"),(0,r.kt)("p",null," conf \u8cc7\u6599\u593e\u4e0b\u65b0\u589e out_loki.conf ,  \u76f8\u95dc\u53c3\u6578\u8acb\u81ea\u884c\u8abf\u6574."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[SERVICE]\n    flush     5\n    log_level info\n\n[INPUT]\n    name      tail\n    path      C:\\flog\\aa.log\n    db        .\\logs.db\n\n[OUTPUT]\n    name                   loki\n    match                  *\n    host                   192.168.1.106\n    port                   3100\n    labels                 job=fluentbit3, instance=192.168.100.36, service=bpm, env=lab\n")),(0,r.kt)("p",null,"\u555f\u52d5 fluent-bit"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"./bin/fluent-bit -c .\\conf\\loki.conf\n")),(0,r.kt)("h2",{id:"log-\u7522\u751f\u5668-\u5982\u679c\u6c92\u6709log-\u53ef\u4f7f\u7528\u4e0b\u5217-repo-\u7522\u751flog"},"LOG \u7522\u751f\u5668 (\u5982\u679c\u6c92\u6709LOG \u53ef\u4f7f\u7528\u4e0b\u5217 repo \u7522\u751fLOG)"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/mingrammer/flog"},"https://github.com/mingrammer/flog")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"./flog -t log -o cc.log  -n 3000 -d 1s\n")),(0,r.kt)("h2",{id:"include-\u5f15\u7528\u591a\u500b\u8a2d\u5b9a\u6a94"},"@INCLUDE \u5f15\u7528\u591a\u500b\u8a2d\u5b9a\u6a94"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://faun.pub/how-to-set-up-multiple-input-output-in-fluent-bit-5f322111de37"},"https://faun.pub/how-to-set-up-multiple-input-output-in-fluent-bit-5f322111de37")),(0,r.kt)("p",null,"fluent-bit \u8cc7\u6599\u7d50\u69cb\u5982\u4e0b, \u53ef\u4ee5\u62c6\u5206\u8907\u96dc\u7684config"),(0,r.kt)("p",null,"\u251c\u2500bin\n\u251c\u2500conf\n\u251c\u2500include\n\u2502  \u251c\u2500fluent-bit\n\u2502  \u2502  \u251c\u2500tls\n\u2502  \u2502  \u2514\u2500wasm\n\u2502  \u251c\u2500luajit\n\u2502  \u2514\u2500monkey\n\u2502      \u2514\u2500mk_core\n\u251c\u2500lib\n\u2514\u2500log"),(0,r.kt)("p",null,"a.conf\nb.conf"),(0,r.kt)("p",null,"multi.conf (\u5167\u5bb9\u5982\u4e0b)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"@INCLUDE a.conf\n@INCLUDE b.conf\n")),(0,r.kt)("h2",{id:"\u8a2d\u5b9a\u53c3\u8003"},"\u8a2d\u5b9a\u53c3\u8003"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/articles/10280701"},"https://ithelp.ithome.com.tw/articles/10280701")),(0,r.kt)("h2",{id:"\u5099\u8a3b"},"\u5099\u8a3b"),(0,r.kt)("p",null,"\u5728Linux \u4e0a\u5b89\u88dd\u6703\u9700\u8981\u7ba1\u7406\u54e1\u6b0a\u9650, \u53ef\u88fd\u4f5cimage \u6a94\u6848, \u57f7\u884ccontainer \u66ff\u4ee3\u672c\u6a5f\u5b89\u88dd."))}f.isMDXComponent=!0}}]);